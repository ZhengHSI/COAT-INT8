==================================================
精度测试汇总
==================================================

矩阵大小: 128x128x128
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.028103
  平均绝对误差: 0.003644
  平均相对误差: 0.003468
INT8 vs FP32:
  最大绝对误差: 0.581214
  平均绝对误差: 0.119200
  平均相对误差: 0.130004
FP8 vs FP32:
  最大绝对误差: 1.880987
  平均绝对误差: 0.339731
  平均相对误差: 0.334774

矩阵大小: 256x256x256
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.045105
  平均绝对误差: 0.005112
  平均相对误差: 0.004018
INT8 vs FP32:
  最大绝对误差: 1.029392
  平均绝对误差: 0.189773
  平均相对误差: 0.272902
FP8 vs FP32:
  最大绝对误差: 3.152014
  平均绝对误差: 0.476682
  平均相对误差: 0.669609

矩阵大小: 384x384x384
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.068115
  平均绝对误差: 0.006174
  平均相对误差: 0.002332
INT8 vs FP32:
  最大绝对误差: 1.445864
  平均绝对误差: 0.237837
  平均相对误差: 0.120540
FP8 vs FP32:
  最大绝对误差: 3.637793
  平均绝对误差: 0.581473
  平均相对误差: 0.327919

矩阵大小: 512x512x512
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.075829
  平均绝对误差: 0.007214
  平均相对误差: 0.003774
INT8 vs FP32:
  最大绝对误差: 1.544914
  平均绝对误差: 0.269735
  平均相对误差: 0.134446
FP8 vs FP32:
  最大绝对误差: 4.272251
  平均绝对误差: 0.678030
  平均相对误差: 0.430281

矩阵大小: 768x768x768
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.085617
  平均绝对误差: 0.008791
  平均相对误差: 0.002416
INT8 vs FP32:
  最大绝对误差: 2.404713
  平均绝对误差: 0.376669
  平均相对误差: 0.139540
FP8 vs FP32:
  最大绝对误差: 5.927959
  平均绝对误差: 0.828117
  平均相对误差: 0.279829

矩阵大小: 1024x1024x1024
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.120407
  平均绝对误差: 0.010172
  平均相对误差: 0.003313
INT8 vs FP32:
  最大绝对误差: 2.513898
  平均绝对误差: 0.422809
  平均相对误差: 0.219013
FP8 vs FP32:
  最大绝对误差: 6.462252
  平均绝对误差: 0.955946
  平均相对误差: 0.510852

矩阵大小: 1536x1536x1536
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.141510
  平均绝对误差: 0.012513
  平均相对误差: 0.003397
INT8 vs FP32:
  最大绝对误差: 3.555292
  平均绝对误差: 0.531203
  平均相对误差: 0.193598
FP8 vs FP32:
  最大绝对误差: 7.195613
  平均绝对误差: 1.173623
  平均相对误差: 0.460236

矩阵大小: 2048x2048x2048
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.150284
  平均绝对误差: 0.014419
  平均相对误差: 0.002461
INT8 vs FP32:
  最大绝对误差: 4.023918
  平均绝对误差: 0.612924
  平均相对误差: 0.143720
FP8 vs FP32:
  最大绝对误差: 9.031790
  平均绝对误差: 1.354620
  平均相对误差: 0.314283

矩阵大小: 2560x2560x2560
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.163849
  平均绝对误差: 0.016086
  平均相对误差: 0.002948
INT8 vs FP32:
  最大绝对误差: 4.606464
  平均绝对误差: 0.725429
  平均相对误差: 0.179703
FP8 vs FP32:
  最大绝对误差: 9.904526
  平均绝对误差: 1.515894
  平均相对误差: 0.360505

矩阵大小: 3072x3072x3072
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.200104
  平均绝对误差: 0.017573
  平均相对误差: 0.003450
INT8 vs FP32:
  最大绝对误差: 5.373848
  平均绝对误差: 0.779856
  平均相对误差: 0.185572
FP8 vs FP32:
  最大绝对误差: 11.466232
  平均绝对误差: 1.659235
  平均相对误差: 0.431809

矩阵大小: 3584x3584x3584
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.239624
  平均绝对误差: 0.019019
  平均相对误差: 0.003404
INT8 vs FP32:
  最大绝对误差: 6.163422
  平均绝对误差: 0.855143
  平均相对误差: 0.192332
FP8 vs FP32:
  最大绝对误差: 13.216532
  平均绝对误差: 1.791912
  平均相对误差: 0.412011

矩阵大小: 4096x4096x4096
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.289307
  平均绝对误差: 0.020326
  平均相对误差: 0.003420
INT8 vs FP32:
  最大绝对误差: 6.810463
  平均绝对误差: 0.957624
  平均相对误差: 0.194922
FP8 vs FP32:
  最大绝对误差: 13.762009
  平均绝对误差: 1.917720
  平均相对误差: 0.402484

矩阵大小: 4608x4608x4608
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.285889
  平均绝对误差: 0.021600
  平均相对误差: 0.002926
INT8 vs FP32:
  最大绝对误差: 6.669376
  平均绝对误差: 0.953259
  平均相对误差: 0.170432
FP8 vs FP32:
  最大绝对误差: 14.104284
  平均绝对误差: 2.031725
  平均相对误差: 0.371856

矩阵大小: 5120x5120x5120
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.282166
  平均绝对误差: 0.022765
  平均相对误差: 0.003457
INT8 vs FP32:
  最大绝对误差: 7.154162
  平均绝对误差: 1.042142
  平均相对误差: 0.200522
FP8 vs FP32:
  最大绝对误差: 14.801086
  平均绝对误差: 2.144225
  平均相对误差: 0.415609

矩阵大小: 5632x5632x5632
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.292419
  平均绝对误差: 0.023912
  平均相对误差: 0.003860
INT8 vs FP32:
  最大绝对误差: 8.049575
  平均绝对误差: 1.083624
  平均相对误差: 0.237815
FP8 vs FP32:
  最大绝对误差: 15.992958
  平均绝对误差: 2.248754
  平均相对误差: 0.455209

矩阵大小: 6144x6144x6144
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.309540
  平均绝对误差: 0.024952
  平均相对误差: 0.003662
INT8 vs FP32:
  最大绝对误差: 7.815598
  平均绝对误差: 1.114288
  平均相对误差: 0.208149
FP8 vs FP32:
  最大绝对误差: 16.752571
  平均绝对误差: 2.348283
  平均相对误差: 0.455186

矩阵大小: 6656x6656x6656
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.321625
  平均绝对误差: 0.025954
  平均相对误差: 0.002897
INT8 vs FP32:
  最大绝对误差: 7.729069
  平均绝对误差: 1.137681
  平均相对误差: 0.170979
FP8 vs FP32:
  最大绝对误差: 17.970810
  平均绝对误差: 2.444252
  平均相对误差: 0.359510

矩阵大小: 7168x7168x7168
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.333313
  平均绝对误差: 0.026932
  平均相对误差: 0.003144
INT8 vs FP32:
  最大绝对误差: 8.702301
  平均绝对误差: 1.253437
  平均相对误差: 0.211718
FP8 vs FP32:
  最大绝对误差: 17.636444
  平均绝对误差: 2.540144
  平均相对误差: 0.429523

矩阵大小: 7680x7680x7680
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.314209
  平均绝对误差: 0.027860
  平均相对误差: 0.003345
INT8 vs FP32:
  最大绝对误差: 9.136295
  平均绝对误差: 1.301524
  平均相对误差: 0.208306
FP8 vs FP32:
  最大绝对误差: 18.680656
  平均绝对误差: 2.628548
  平均相对误差: 0.410685

矩阵大小: 8192x8192x8192
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.336914
  平均绝对误差: 0.028790
  平均相对误差: 0.003276
INT8 vs FP32:
  最大绝对误差: 10.632233
  平均绝对误差: 1.370345
  平均相对误差: 0.205708
FP8 vs FP32:
  最大绝对误差: 19.745979
  平均绝对误差: 2.716058
  平均相对误差: 0.423864

矩阵大小: 8704x8704x8704
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.362091
  平均绝对误差: 0.029651
  平均相对误差: 0.003102
INT8 vs FP32:
  最大绝对误差: 10.844955
  平均绝对误差: 1.393357
  平均相对误差: 0.194808
FP8 vs FP32:
  最大绝对误差: 22.536440
  平均绝对误差: 2.799344
  平均相对误差: 0.397735

矩阵大小: 9216x9216x9216
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.423462
  平均绝对误差: 0.030528
  平均相对误差: 0.003725
INT8 vs FP32:
  最大绝对误差: 10.110382
  平均绝对误差: 1.398973
  平均相对误差: 0.256312
FP8 vs FP32:
  最大绝对误差: 20.590065
  平均绝对误差: 2.879501
  平均相对误差: 0.454459

矩阵大小: 9728x9728x9728
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.471375
  平均绝对误差: 0.031369
  平均相对误差: 0.003709
INT8 vs FP32:
  最大绝对误差: 10.384190
  平均绝对误差: 1.459025
  平均相对误差: 0.197013
FP8 vs FP32:
  最大绝对误差: 22.071846
  平均绝对误差: 2.959728
  平均相对误差: 0.415093

矩阵大小: 10240x10240x10240
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.380859
  平均绝对误差: 0.032146
  平均相对误差: 0.003290
INT8 vs FP32:
  最大绝对误差: 12.082558
  平均绝对误差: 1.560046
  平均相对误差: 0.212423
FP8 vs FP32:
  最大绝对误差: 22.593353
  平均绝对误差: 3.037647
  平均相对误差: 0.424942

矩阵大小: 11264x11264x11264
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.502563
  平均绝对误差: 0.033721
  平均相对误差: 0.003417
INT8 vs FP32:
  最大绝对误差: 11.806725
  平均绝对误差: 1.617848
  平均相对误差: 0.213414
FP8 vs FP32:
  最大绝对误差: 23.825716
  平均绝对误差: 3.186652
  平均相对误差: 0.407773

矩阵大小: 12288x12288x12288
------------------------------
FP16 vs FP32:
  最大绝对误差: 0.500244
  平均绝对误差: 0.035255
  平均相对误差: 0.003371
INT8 vs FP32:
  最大绝对误差: 12.650414
  平均绝对误差: 1.682869
  平均相对误差: 0.215204
FP8 vs FP32:
  最大绝对误差: 22.923336
  平均绝对误差: 3.328340
  平均相对误差: 0.412956


==================================================
性能测试汇总
==================================================

TFLOPS 性能:
------------------------------
Size              FP32        FP16        INT8         FP8
128               0.30        0.39        0.04        0.22
256               1.88        2.96        0.31        1.09
384               5.14        9.24        0.97        2.69
512               9.52       17.44        2.28        5.04
768              15.76       38.89        6.87       11.88
1024             20.74       60.51       15.00       21.78
1536             25.76       95.12       39.84       49.89
2048             23.75       97.95       53.64       46.15
2560             24.56      107.73       66.01       48.27
3072             25.01      118.64       77.51       51.66
3584             25.10      119.49       80.26       47.92
4096             25.08      118.19       85.60       53.11
4608             24.69      130.02       84.24       51.76
5120             24.83      130.29       85.89       52.25
5632             24.84      132.97       85.83       53.45
6144             24.94      133.24       88.25       54.78
6656             25.00      134.90       85.33       53.90
7168             25.10      135.12       88.80       53.75
7680             23.98      136.50       86.00       54.07
8192             25.01      137.24       87.17       54.40
8704             32.20      137.11       87.39       54.89
9216             23.97      137.82       86.92       54.87
9728             24.97      138.21       86.68       54.80
10240            32.26      136.69       86.94       54.74
11264            32.40      138.71       85.55       55.03
12288            28.49      138.25       85.05       54.98

Triton Benchmark 加速比:
------------------------------

相对FP32加速比:
Size              FP16        INT8         FP8
128               1.29x        0.13x        0.72x
256               1.58x        0.17x        0.58x
384               1.80x        0.19x        0.52x
512               1.83x        0.24x        0.53x
768               2.47x        0.44x        0.75x
1024              2.92x        0.72x        1.05x
1536              3.69x        1.55x        1.94x
2048              4.12x        2.26x        1.94x
2560              4.39x        2.69x        1.97x
3072              4.74x        3.10x        2.07x
3584              4.76x        3.20x        1.91x
4096              4.71x        3.41x        2.12x
4608              5.27x        3.41x        2.10x
5120              5.25x        3.46x        2.10x
5632              5.35x        3.45x        2.15x
6144              5.34x        3.54x        2.20x
6656              5.40x        3.41x        2.16x
7168              5.38x        3.54x        2.14x
7680              5.69x        3.59x        2.25x
8192              5.49x        3.49x        2.17x
8704              4.26x        2.71x        1.70x
9216              5.75x        3.63x        2.29x
9728              5.53x        3.47x        2.19x
10240             4.24x        2.69x        1.70x
11264             4.28x        2.64x        1.70x
12288             4.85x        2.99x        1.93x

相对FP16加速比:
Size              FP32        INT8         FP8
128               0.78x        0.10x        0.56x
256               0.63x        0.11x        0.37x
384               0.56x        0.11x        0.29x
512               0.55x        0.13x        0.29x
768               0.41x        0.18x        0.31x
1024              0.34x        0.25x        0.36x
1536              0.27x        0.42x        0.52x
2048              0.24x        0.55x        0.47x
2560              0.23x        0.61x        0.45x
3072              0.21x        0.65x        0.44x
3584              0.21x        0.67x        0.40x
4096              0.21x        0.72x        0.45x
4608              0.19x        0.65x        0.40x
5120              0.19x        0.66x        0.40x
5632              0.19x        0.65x        0.40x
6144              0.19x        0.66x        0.41x
6656              0.19x        0.63x        0.40x
7168              0.19x        0.66x        0.40x
7680              0.18x        0.63x        0.40x
8192              0.18x        0.64x        0.40x
8704              0.23x        0.64x        0.40x
9216              0.17x        0.63x        0.40x
9728              0.18x        0.63x        0.40x
10240             0.24x        0.64x        0.40x
11264             0.23x        0.62x        0.40x
12288             0.21x        0.62x        0.40x

Old Method 加速比:
------------------------------

相对FP32加速比:
Size              FP16        INT8         FP8
128               1.12x        0.25x        0.44x
256               0.93x        0.23x        0.36x
384               1.19x        0.28x        0.40x
512               1.66x        0.34x        0.43x
768               2.11x        0.54x        0.60x
1024              2.35x        0.83x        0.83x
1536              3.24x        1.65x        1.59x
2048              3.89x        2.49x        1.80x
2560              4.22x        2.78x        1.90x
3072              4.63x        3.13x        2.00x
3584              4.74x        3.24x        1.87x
4096              5.38x        3.63x        2.18x
4608              5.48x        3.62x        2.18x
5120              5.52x        3.65x        2.20x
5632              5.74x        3.70x        2.28x
6144              5.69x        3.76x        2.32x
6656              5.74x        3.60x        2.26x
7168              5.70x        3.68x        2.25x
7680              5.80x        3.66x        2.27x
8192              5.86x        3.71x        2.31x
8704              4.35x        2.76x        1.73x
9216              5.85x        3.65x        2.30x
9728              5.89x        3.65x        2.30x
10240             4.36x        2.74x        1.73x
11264             4.42x        2.71x        1.75x
12288             4.57x        2.82x        1.82x

相对FP16加速比:
Size              FP32        INT8         FP8
128               0.89x        0.22x        0.39x
256               1.07x        0.25x        0.39x
384               0.84x        0.24x        0.33x
512               0.60x        0.20x        0.26x
768               0.47x        0.25x        0.28x
1024              0.43x        0.35x        0.35x
1536              0.31x        0.51x        0.49x
2048              0.26x        0.64x        0.46x
2560              0.24x        0.66x        0.45x
3072              0.22x        0.68x        0.43x
3584              0.21x        0.68x        0.39x
4096              0.19x        0.67x        0.41x
4608              0.18x        0.66x        0.40x
5120              0.18x        0.66x        0.40x
5632              0.17x        0.64x        0.40x
6144              0.18x        0.66x        0.41x
6656              0.17x        0.63x        0.39x
7168              0.18x        0.65x        0.40x
7680              0.17x        0.63x        0.39x
8192              0.17x        0.63x        0.39x
8704              0.23x        0.63x        0.40x
9216              0.17x        0.62x        0.39x
9728              0.17x        0.62x        0.39x
10240             0.23x        0.63x        0.40x
11264             0.23x        0.61x        0.40x
12288             0.22x        0.62x        0.40x
